{"version":3,"file":"rateLimiter.js","sourceRoot":"","sources":["../../middleware/rateLimiter.ts"],"names":[],"mappings":";;;;;;AAAA,4EAA2C;AAE3C,qCAAqC;AACrC,MAAM,qBAAqB,GAAG,IAAA,4BAAS,EAAC;IACtC,QAAQ,EAAE,CAAC,GAAG,EAAE,GAAG,IAAI,EAAE,+CAA+C;IACxE,GAAG,EAAE,CAAC,EAAE,8CAA8C;IACtD,OAAO,EAAE,EAAE,KAAK,EAAE,oDAAoD,EAAE;IACxE,eAAe,EAAE,IAAI,EAAE,kCAAkC;IACzD,aAAa,EAAE,KAAK,EAAE,qCAAqC;CAC5D,CAAC,CAAC;AA8BD,sDAAqB;AA5BvB,oCAAoC;AACpC,MAAM,oBAAoB,GAAG,IAAA,4BAAS,EAAC;IACrC,QAAQ,EAAE,CAAC,GAAG,EAAE,GAAG,IAAI;IACvB,GAAG,EAAE,CAAC,EAAE,+CAA+C;IACvD,OAAO,EAAE,EAAE,KAAK,EAAE,2CAA2C,EAAE;IAC/D,eAAe,EAAE,IAAI;IACrB,aAAa,EAAE,KAAK;CACrB,CAAC,CAAC;AAsBD,oDAAoB;AApBtB,yBAAyB;AACzB,MAAM,YAAY,GAAG,IAAA,4BAAS,EAAC;IAC7B,QAAQ,EAAE,CAAC,GAAG,EAAE,GAAG,IAAI,EAAE,eAAe;IACxC,GAAG,EAAE,CAAC,EAAE,uCAAuC;IAC/C,OAAO,EAAE,EAAE,KAAK,EAAE,2CAA2C,EAAE;IAC/D,eAAe,EAAE,IAAI;IACrB,aAAa,EAAE,KAAK;CACrB,CAAC,CAAC;AAcD,oCAAY;AAZd,0BAA0B;AAC1B,MAAM,aAAa,GAAG,IAAA,4BAAS,EAAC;IAC9B,QAAQ,EAAE,CAAC,GAAG,EAAE,GAAG,IAAI;IACvB,GAAG,EAAE,CAAC;IACN,OAAO,EAAE,EAAE,KAAK,EAAE,4CAA4C,EAAE;IAChE,eAAe,EAAE,IAAI;IACrB,aAAa,EAAE,KAAK;CACrB,CAAC,CAAC;AAMD,sCAAa","sourcesContent":["import rateLimit from 'express-rate-limit';\n\n// Rate limiter for \"Forgot Password\"\nconst forgotPasswordLimiter = rateLimit({\n  windowMs: 2 * 60 * 1000, // window should be as large as OTP expiry time\n  max: 5, // Limit each IP to 5 requests every 2 minutes\n  message: { error: 'Too many password reset attempts. Try again later.' },\n  standardHeaders: true, // Send rate limit info in headers\n  legacyHeaders: false, // Disable X-RateLimit legacy headers\n});\n\n// Rate limiter for \"Reset Password\"\nconst resetPasswordLimiter = rateLimit({\n  windowMs: 2 * 60 * 1000,\n  max: 3, // Limit each IP to 3 reset attempts per window\n  message: { error: 'Too many reset attempts. Try again later.' },\n  standardHeaders: true,\n  legacyHeaders: false,\n});\n\n// Rate limiter for Login\nconst loginLimiter = rateLimit({\n  windowMs: 1 * 60 * 1000, // 1 min window\n  max: 5, // Attempt to login in 5 times a minute\n  message: { error: 'Too many login attempts. Try again later.' },\n  standardHeaders: true,\n  legacyHeaders: false,\n});\n\n// Rate limiter for signup\nconst signupLimiter = rateLimit({\n  windowMs: 1 * 60 * 1000,\n  max: 5,\n  message: { error: 'Too many signup attempts. Try again later.' },\n  standardHeaders: true,\n  legacyHeaders: false,\n});\n\nexport {\n  forgotPasswordLimiter,\n  resetPasswordLimiter,\n  loginLimiter,\n  signupLimiter,\n};\n"]}