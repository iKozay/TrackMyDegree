{"version":3,"file":"adminRoutes.js","sourceRoot":"","sources":["../../../routes/mongo/adminRoutes.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Admin Routes\n *\n * Handles admin operations including database management\n */\n\nimport HTTP from '@Util/HTTPCodes';\nimport express, { Request, Response } from 'express';\nimport { adminController } from '@controllers/mondoDBControllers';\n\nconst router = express.Router();\n\n// ==========================\n// ADMIN ROUTES\n// ==========================\n\nconst INTERNAL_SERVER_ERROR = 'Internal server error';\nconst COLLECTION_NAME_REQUIRED = 'Collection name is required';\nconst NOT_AVAILABLE = 'not available';\n\n/**\n * GET /admin/collections - Get all collections\n */\nrouter.get('/collections', async (req: Request, res: Response) => {\n  try {\n    const collections = await adminController.getCollections();\n    res.status(HTTP.OK).json({\n      message: 'Collections retrieved successfully',\n      collections,\n    });\n  } catch (error) {\n    console.error('Error in GET /admin/collections', error);\n    if (error instanceof Error && error.message.includes(NOT_AVAILABLE)) {\n      res.status(HTTP.SERVER_ERR).json({ error: error.message });\n    } else {\n      res.status(HTTP.SERVER_ERR).json({ error: INTERNAL_SERVER_ERROR });\n    }\n  }\n});\n\n/**\n * GET /admin/collections/:collectionName/documents - Get documents from collection\n */\nrouter.get(\n  '/collections/:collectionName/documents',\n  async (req: Request, res: Response) => {\n    try {\n      const { collectionName } = req.params;\n      const { keyword, page, limit } = req.query;\n\n      if (!collectionName) {\n        res.status(HTTP.BAD_REQUEST).json({\n          error: COLLECTION_NAME_REQUIRED,\n        });\n        return;\n      }\n\n      const documents = await adminController.getCollectionDocuments(\n        collectionName,\n        {\n          keyword: keyword as string,\n          page: page ? parseInt(page as string) : undefined,\n          limit: limit ? parseInt(limit as string) : undefined,\n        },\n      );\n\n      res.status(HTTP.OK).json({\n        message: 'Documents retrieved successfully',\n        documents,\n      });\n    } catch (error) {\n      console.error(\n        'Error in GET /admin/collections/:collectionName/documents',\n        error,\n      );\n      res.status(HTTP.SERVER_ERR).json({ error: INTERNAL_SERVER_ERROR });\n    }\n  },\n);\n\n/**\n * GET /admin/collections/:collectionName/stats - Get collection statistics\n */\nrouter.get(\n  '/collections/:collectionName/stats',\n  async (req: Request, res: Response) => {\n    try {\n      const { collectionName } = req.params;\n\n      if (!collectionName) {\n        res.status(HTTP.BAD_REQUEST).json({\n          error: COLLECTION_NAME_REQUIRED,\n        });\n        return;\n      }\n\n      const stats = await adminController.getCollectionStats(collectionName);\n      res.status(HTTP.OK).json({\n        message: 'Statistics retrieved successfully',\n        stats,\n      });\n    } catch (error) {\n      console.error(\n        'Error in GET /admin/collections/:collectionName/stats',\n        error,\n      );\n      if (error instanceof Error && error.message.includes(NOT_AVAILABLE)) {\n        res.status(HTTP.SERVER_ERR).json({ error: error.message });\n      } else {\n        res.status(HTTP.SERVER_ERR).json({ error: INTERNAL_SERVER_ERROR });\n      }\n    }\n  },\n);\n\n/**\n * DELETE /admin/collections/:collectionName/clear - Clear collection\n */\nrouter.delete(\n  '/collections/:collectionName/clear',\n  async (req: Request, res: Response) => {\n    try {\n      const { collectionName } = req.params;\n\n      if (!collectionName) {\n        res.status(HTTP.BAD_REQUEST).json({\n          error: COLLECTION_NAME_REQUIRED,\n        });\n        return;\n      }\n\n      const count = await adminController.clearCollection(collectionName);\n      res.status(HTTP.OK).json({\n        message: `Collection cleared successfully`,\n        deletedCount: count,\n      });\n    } catch (error) {\n      console.error(\n        'Error in DELETE /admin/collections/:collectionName/clear',\n        error,\n      );\n      if (error instanceof Error && error.message.includes(NOT_AVAILABLE)) {\n        res.status(HTTP.SERVER_ERR).json({ error: error.message });\n      } else {\n        res.status(HTTP.SERVER_ERR).json({ error: INTERNAL_SERVER_ERROR });\n      }\n    }\n  },\n);\n\n/**\n * GET /admin/connection-status - Get database connection status\n */\nrouter.get('/connection-status', async (req: Request, res: Response) => {\n  try {\n    const status = await adminController.getConnectionStatus();\n    res.status(HTTP.OK).json({\n      message: 'Connection status retrieved successfully',\n      ...status,\n    });\n  } catch (error) {\n    console.error('Error in GET /admin/connection-status', error);\n    res.status(HTTP.SERVER_ERR).json({ error: INTERNAL_SERVER_ERROR });\n  }\n});\n\nexport default router;\n"]}