{"version":3,"file":"timelineRoutes.js","sourceRoot":"","sources":["../../../routes/mongo/timelineRoutes.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Timeline Routes\n *\n * Handles timeline CRUD operations\n */\n\nimport HTTP from '@Util/HTTPCodes';\nimport express, { Request, Response } from 'express';\nimport { timelineController } from '@controllers/mondoDBControllers';\n\nconst router = express.Router();\n\n// ==========================\n// TIMELINE ROUTES (CRUD)\n// ==========================\n\nconst INTERNAL_SERVER_ERROR = 'Internal server error';\nconst TIMELINE_ID_REQUIRED = 'Timeline ID is required';\n/**\n * POST /timeline - Save timeline\n */\nrouter.post('/', async (req: Request, res: Response) => {\n  try {\n    const timelineData = req.body;\n\n    if (\n      !timelineData.user_id ||\n      !timelineData.name ||\n      !timelineData.degree_id\n    ) {\n      res.status(HTTP.BAD_REQUEST).json({\n        error: 'User ID, timeline name, and degree ID are required',\n      });\n      return;\n    }\n\n    const timeline = await timelineController.saveTimeline(timelineData);\n    res.status(HTTP.CREATED).json({\n      message: 'Timeline saved successfully',\n      timeline,\n    });\n  } catch (error) {\n    console.error('Error in POST /timeline', error);\n    res.status(HTTP.SERVER_ERR).json({ error: INTERNAL_SERVER_ERROR });\n  }\n});\n\n/**\n * GET /timeline/user/:userId - Get timelines for user\n */\nrouter.get('/user/:userId', async (req: Request, res: Response) => {\n  try {\n    const { userId } = req.params;\n\n    if (!userId) {\n      res.status(HTTP.BAD_REQUEST).json({\n        error: 'User ID is required',\n      });\n      return;\n    }\n\n    const timelines = await timelineController.getTimelinesByUser(userId);\n    res.status(HTTP.OK).json({\n      message: 'Timelines retrieved successfully',\n      timelines,\n    });\n  } catch (error) {\n    console.error('Error in GET /timeline/user/:userId', error);\n    res.status(HTTP.SERVER_ERR).json({ error: INTERNAL_SERVER_ERROR });\n  }\n});\n\n/**\n * GET /timeline/:id - Get timeline by ID\n */\nrouter.get('/:id', async (req: Request, res: Response) => {\n  try {\n    const { id } = req.params;\n\n    if (!id) {\n      res.status(HTTP.BAD_REQUEST).json({\n        error: TIMELINE_ID_REQUIRED,\n      });\n      return;\n    }\n\n    const timeline = await timelineController.getTimelineById(id);\n    res.status(HTTP.OK).json({\n      message: 'Timeline retrieved successfully',\n      timeline,\n    });\n  } catch (error) {\n    console.error('Error in GET /timeline/:id', error);\n    if (error instanceof Error && error.message.includes('not found')) {\n      res.status(HTTP.NOT_FOUND).json({ error: error.message });\n    } else {\n      res.status(HTTP.SERVER_ERR).json({ error: INTERNAL_SERVER_ERROR });\n    }\n  }\n});\n\n/**\n * PUT /timeline/:id - Update timeline\n */\nrouter.put('/:id', async (req: Request, res: Response) => {\n  try {\n    const { id } = req.params;\n    const updates = req.body;\n\n    if (!id) {\n      res.status(HTTP.BAD_REQUEST).json({\n        error: TIMELINE_ID_REQUIRED,\n      });\n      return;\n    }\n\n    const timeline = await timelineController.updateTimeline(id, updates);\n    res.status(HTTP.OK).json({\n      message: 'Timeline updated successfully',\n      timeline,\n    });\n  } catch (error) {\n    console.error('Error in PUT /timeline/:id', error);\n    if (error instanceof Error && error.message.includes('not found')) {\n      res.status(HTTP.NOT_FOUND).json({ error: error.message });\n    } else {\n      res.status(HTTP.SERVER_ERR).json({ error: INTERNAL_SERVER_ERROR });\n    }\n  }\n});\n\n/**\n * DELETE /timeline/:id - Delete timeline\n */\nrouter.delete('/:id', async (req: Request, res: Response) => {\n  try {\n    const { id } = req.params;\n\n    if (!id) {\n      res.status(HTTP.BAD_REQUEST).json({\n        error: TIMELINE_ID_REQUIRED,\n      });\n      return;\n    }\n\n    const result = await timelineController.removeUserTimeline(id);\n    res.status(HTTP.OK).json(result);\n  } catch (error) {\n    console.error('Error in DELETE /timeline/:id', error);\n    res.status(HTTP.SERVER_ERR).json({ error: INTERNAL_SERVER_ERROR });\n  }\n});\n\n/**\n * DELETE /timeline/user/:userId - Delete all timelines for user\n */\nrouter.delete('/user/:userId', async (req: Request, res: Response) => {\n  try {\n    const { userId } = req.params;\n\n    if (!userId) {\n      res.status(HTTP.BAD_REQUEST).json({\n        error: 'User ID is required',\n      });\n      return;\n    }\n\n    const count = await timelineController.deleteAllUserTimelines(userId);\n    res.status(HTTP.OK).json({\n      message: `Deleted ${count} timelines for user`,\n      deletedCount: count,\n    });\n  } catch (error) {\n    console.error('Error in DELETE /timeline/user/:userId', error);\n    res.status(HTTP.SERVER_ERR).json({ error: INTERNAL_SERVER_ERROR });\n  }\n});\n\nexport default router;\n"]}