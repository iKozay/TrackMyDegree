{"version":3,"file":"feedbackRoutes.js","sourceRoot":"","sources":["../../../routes/mongo/feedbackRoutes.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Feedback Routes\n *\n * Handles feedback CRUD operations\n */\n\nimport HTTP from '@Util/HTTPCodes';\nimport express, { Request, Response } from 'express';\nimport { feedbackController } from '@controllers/mondoDBControllers';\n\nconst router = express.Router();\n\n// ==========================\n// FEEDBACK ROUTES (CRUD)\n// ==========================\n\nconst INTERNAL_SERVER_ERROR = 'Internal server error';\n\n/**\n * POST /feedback - Submit feedback\n */\nrouter.post('/', async (req: Request, res: Response) => {\n  try {\n    const { message, user_id } = req.body;\n\n    if (!message) {\n      res.status(HTTP.BAD_REQUEST).json({\n        error: 'Missing required field: message',\n      });\n      return;\n    }\n\n    const feedback = await feedbackController.submitFeedback(message, user_id);\n    res.status(HTTP.CREATED).json({\n      message: 'Feedback submitted successfully',\n      feedback,\n    });\n  } catch (error) {\n    console.error('Error in POST /feedback', error);\n    res.status(HTTP.SERVER_ERR).json({ error: INTERNAL_SERVER_ERROR });\n  }\n});\n\n/**\n * GET /feedback - Get all feedback\n */\nrouter.get('/', async (req: Request, res: Response) => {\n  try {\n    const { user_id, page, limit, sort } = req.query;\n\n    const feedback = await feedbackController.getAllFeedback({\n      user_id: user_id as string,\n      page: page ? parseInt(page as string) : undefined,\n      limit: limit ? parseInt(limit as string) : undefined,\n      sort: sort as 'asc' | 'desc',\n    });\n\n    res.status(HTTP.OK).json({\n      message: 'Feedback retrieved successfully',\n      feedback,\n    });\n  } catch (error) {\n    console.error('Error in GET /feedback', error);\n    res.status(HTTP.SERVER_ERR).json({ error: INTERNAL_SERVER_ERROR });\n  }\n});\n\n/**\n * GET /feedback/:id - Get feedback by ID\n */\nrouter.get('/:id', async (req: Request, res: Response) => {\n  try {\n    const { id } = req.params;\n\n    if (!id) {\n      res.status(HTTP.BAD_REQUEST).json({\n        error: 'Feedback ID is required',\n      });\n      return;\n    }\n\n    const feedback = await feedbackController.getFeedbackById(id);\n    res.status(HTTP.OK).json({\n      message: 'Feedback retrieved successfully',\n      feedback,\n    });\n  } catch (error) {\n    console.error('Error in GET /feedback/:id', error);\n    if (error instanceof Error && error.message.includes('not found')) {\n      res.status(HTTP.NOT_FOUND).json({ error: error.message });\n    } else {\n      res.status(HTTP.SERVER_ERR).json({ error: INTERNAL_SERVER_ERROR });\n    }\n  }\n});\n\n/**\n * DELETE /feedback/:id - Delete feedback\n */\nrouter.delete('/:id', async (req: Request, res: Response) => {\n  try {\n    const { id } = req.params;\n\n    if (!id) {\n      res.status(HTTP.BAD_REQUEST).json({\n        error: 'Feedback ID is required',\n      });\n      return;\n    }\n\n    const message = await feedbackController.deleteFeedback(id);\n    res.status(HTTP.OK).json({\n      message,\n    });\n  } catch (error) {\n    console.error('Error in DELETE /feedback/:id', error);\n    if (error instanceof Error && error.message.includes('not found')) {\n      res.status(HTTP.NOT_FOUND).json({ error: error.message });\n    } else {\n      res.status(HTTP.SERVER_ERR).json({ error: INTERNAL_SERVER_ERROR });\n    }\n  }\n});\n\n/**\n * DELETE /feedback/user/:userId - Delete all feedback for user\n */\nrouter.delete('/user/:userId', async (req: Request, res: Response) => {\n  try {\n    const { userId } = req.params;\n\n    if (!userId) {\n      res.status(HTTP.BAD_REQUEST).json({\n        error: 'User ID is required',\n      });\n      return;\n    }\n\n    const count = await feedbackController.deleteUserFeedback(userId);\n    res.status(HTTP.OK).json({\n      message: 'All user feedback deleted successfully',\n      deletedCount: count,\n    });\n  } catch (error) {\n    console.error('Error in DELETE /feedback/user/:userId', error);\n    res.status(HTTP.SERVER_ERR).json({ error: INTERNAL_SERVER_ERROR });\n  }\n});\n\nexport default router;\n"]}