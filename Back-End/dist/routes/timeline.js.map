{"version":3,"file":"timeline.js","sourceRoot":"","sources":["../../routes/timeline.ts"],"names":[],"mappings":"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","sourcesContent":["import express, { Request, Response } from 'express';\nimport timelineController from '@controllers/timelineController/timelineController';\nimport HTTP from '@Util/HTTPCodes';\nimport asyncHandler from '@middleware/asyncHandler';\nimport {\n  validateTimelineBody,\n  validateUserId,\n  validateTimelineId,\n} from '@middleware/timelineValidators';\n\nconst router = express.Router();\n\n/**\n * POST /api/timeline\n * Creates a new timeline.\n * Body: { timeline: {...} }\n */\nrouter.post(\n  '/',\n  validateTimelineBody,\n  asyncHandler(async (req: Request, res: Response) => {\n    const { timeline } = req.body;\n\n    if (!timeline || Object.keys(timeline).length === 0) {\n      return res\n        .status(HTTP.BAD_REQUEST)\n        .json({ error: 'Timeline data is required' });\n    }\n\n    const savedTimeline = await timelineController.saveTimeline(timeline);\n\n    if (savedTimeline) {\n      return res.status(HTTP.OK).json(savedTimeline);\n    } else {\n      return res\n        .status(HTTP.SERVER_ERR)\n        .json({ error: 'Could not save timeline' });\n    }\n  }),\n);\n\n/**\n * PUT /api/timeline/:timelineId\n * Updates an existing timeline using the provided ID.\n * Body: { timeline: {...} }\n */\nrouter.put(\n  '/:timelineId',\n  validateTimelineBody,\n  asyncHandler(async (req: Request, res: Response) => {\n    const { timelineId } = req.params;\n    const { timeline } = req.body;\n\n    if (!timeline || Object.keys(timeline).length === 0) {\n      return res\n        .status(HTTP.BAD_REQUEST)\n        .json({ error: 'Timeline data is required' });\n    }\n\n    timeline.id = timelineId; // Ensure correct ID for update\n    const savedTimeline = await timelineController.saveTimeline(timeline);\n\n    if (savedTimeline) {\n      return res.status(HTTP.OK).json(savedTimeline);\n    } else {\n      return res\n        .status(HTTP.SERVER_ERR)\n        .json({ error: 'Could not save/update timeline' });\n    }\n  }),\n);\n\n/**\n * GET /api/timeline/user/:userId\n * Retrieves all timelines for the specified user.\n */\nrouter.get(\n  '/user/:userId',\n  validateUserId,\n  asyncHandler(async (req: Request, res: Response) => {\n    const { userId } = req.params;\n    const timelines = await timelineController.getTimelinesByUser(userId);\n\n    if (timelines && timelines.length > 0) {\n      return res.status(HTTP.OK).json(timelines);\n    } else {\n      return res.status(HTTP.OK).json({ message: 'No timelines found' });\n    }\n  }),\n);\n\n/**\n * DELETE /api/timeline/:timelineId\n * Deletes a timeline by its ID.\n */\nrouter.delete(\n  '/:timelineId',\n  validateTimelineId,\n  asyncHandler(async (req: Request, res: Response) => {\n    const { timelineId } = req.params;\n    const result = await timelineController.removeUserTimeline(timelineId);\n\n    // âœ… Defensive check\n    if (!result || typeof result !== 'object' || !('message' in result)) {\n      return res\n        .status(HTTP.SERVER_ERR)\n        .json({ error: 'Unexpected response from controller' });\n    }\n\n    const { success, message } = result;\n\n    if (success && message.includes('deleted successfully')) {\n      return res.status(HTTP.OK).json({ message });\n    } else if (message.includes('No timeline found')) {\n      return res.status(HTTP.NOT_FOUND).json({ error: message });\n    } else {\n      return res\n        .status(HTTP.SERVER_ERR)\n        .json({ error: 'Internal Server Error' });\n    }\n  }),\n);\n\nexport default router;\n"]}