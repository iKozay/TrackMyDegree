{"version":3,"file":"FeedbackController.js","sourceRoot":"","sources":["../../../controllers/mondoDBControllers/FeedbackController.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Provides simple feedback operations with consistent interface.\n */\n\nimport { BaseMongoController } from './BaseMongoController';\nimport { Feedback } from '../../models';\n\nexport interface FeedbackData {\n  _id: string;\n  message: string;\n  user_id?: string | null;\n  submitted_at?: Date;\n}\n\nexport class FeedbackController extends BaseMongoController<any> {\n  constructor() {\n    super(Feedback, 'Feedback');\n  }\n\n  /**\n   * Submit feedback\n   */\n  async submitFeedback(\n    message: string,\n    user_id?: string,\n  ): Promise<FeedbackData> {\n    try {\n      const result = await this.create({\n        message,\n        user_id: user_id || null,\n        submitted_at: new Date(),\n      });\n\n      if (!result.success) {\n        throw new Error(result.error || 'Failed to submit feedback');\n      }\n\n      return {\n        _id: result.data._id,\n        message: result.data.message,\n        user_id: result.data.user_id,\n        submitted_at: result.data.submitted_at,\n      };\n    } catch (error) {\n      this.handleError(error, 'submitFeedback');\n    }\n  }\n\n  /**\n   * Get all feedback with optional filtering and pagination\n   */\n  async getAllFeedback(\n    options: {\n      user_id?: string;\n      page?: number;\n      limit?: number;\n      sort?: 'asc' | 'desc';\n    } = {},\n  ): Promise<FeedbackData[]> {\n    try {\n      const { user_id, page, limit, sort = 'desc' } = options;\n\n      const filter: any = {};\n      if (user_id) {\n        filter.user_id = user_id;\n      }\n\n      const result = await this.findAll(filter, {\n        page,\n        limit,\n        sort: { submitted_at: sort === 'desc' ? -1 : 1 },\n      });\n\n      if (!result.success) {\n        throw new Error(result.error || 'Failed to fetch feedback');\n      }\n\n      return (result.data || []).map((f) => ({\n        _id: f._id,\n        message: f.message,\n        user_id: f.user_id,\n        submitted_at: f.submitted_at,\n      }));\n    } catch (error) {\n      this.handleError(error, 'getAllFeedback');\n    }\n  }\n\n  /**\n   * Get feedback by ID\n   */\n  async getFeedbackById(feedback_id: string): Promise<FeedbackData> {\n    try {\n      const result = await this.findById(feedback_id);\n\n      if (!result.success) {\n        throw new Error(result.error || 'Feedback not found');\n      }\n\n      return {\n        _id: result.data._id,\n        message: result.data.message,\n        user_id: result.data.user_id,\n        submitted_at: result.data.submitted_at,\n      };\n    } catch (error) {\n      this.handleError(error, 'getFeedbackById');\n    }\n  }\n\n  /**\n   * Delete feedback by ID\n   */\n  async deleteFeedback(feedback_id: string): Promise<string> {\n    try {\n      const result = await this.deleteById(feedback_id);\n\n      if (!result.success) {\n        throw new Error(result.error || 'Feedback not found');\n      }\n\n      return result.message!;\n    } catch (error) {\n      this.handleError(error, 'deleteFeedback');\n    }\n  }\n\n  /**\n   * Delete all feedback for a user\n   */\n  async deleteUserFeedback(user_id: string): Promise<number> {\n    try {\n      const result = await this.deleteMany({ user_id });\n\n      if (!result.success) {\n        throw new Error(result.error || 'Failed to delete feedback');\n      }\n\n      return result.data || 0;\n    } catch (error) {\n      this.handleError(error, 'deleteUserFeedback');\n    }\n  }\n}\n\nexport const feedbackController = new FeedbackController();\n"]}