{"version":3,"file":"index.js","sourceRoot":"","sources":["../index.ts"],"names":[],"mappings":"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","sourcesContent":["import * as Sentry from '@sentry/node';\nimport express from 'express';\nimport cors from 'cors';\nimport corsOptions from '@middleware/corsMiddleware';\nimport dotenv from 'dotenv';\nimport cookieParser from 'cookie-parser';\nimport Database from '@controllers/DBController/DBController';\nimport HTTP from '@Util/HTTPCodes';\nimport {\n  forgotPasswordLimiter,\n  resetPasswordLimiter,\n  loginLimiter,\n  signupLimiter,\n} from '@middleware/rateLimiter';\nimport { notFoundHandler, errorHandler } from '@middleware/errorHandler';\n\n//Routes import\nimport authRouter from '@routes/auth';\nimport coursesRouter from '@routes/courses';\nimport exemptionRouter from '@routes/exemption';\nimport deficiencyRouter from '@routes/deficiency';\nimport degreeRouter from '@routes/degree';\nimport timelineRouter from '@routes/timeline';\nimport coursepoolRouter from '@routes/coursepool';\nimport userDataRouter from '@routes/userData';\nimport Admin from '@routes/adminRoutes';\nimport requisiteRouter from '@routes/requisite';\nimport feedbackRouter from '@routes/feedback';\nimport sessionRouter from '@routes/session';\nimport sectionsRoutes from '@routes/sectionsRoutes';\nimport transcriptRouter from '@routes/transcript';\nimport mongoRouter from '@routes/mongo';\n\n//Dev Consts\nconst HOPPSCOTCH = 'chrome-extension://amknoiejhlmhancpahfcfcfhllgkpbld';\n\n//Express Init\ndotenv.config(); //Load environment variables from .env file\nconst app = express();\nconst PORT = process.env.PORT || 8000;\nconst CLIENT = process.env.CLIENT || 'http://localhost:3000';\n\nSentry.setupExpressErrorHandler(app);\n\n// Apply the CORS middleware\napp.use(cors(corsOptions));\n\n// Preflight handling for all routes\napp.options('*', cors(corsOptions));\n\napp.use(express.urlencoded({ extended: false }));\napp.use(express.json());\napp.use(cookieParser());\n\n// Apply rate limiters of forgot-password and reset-password routes\napp.use('/auth/forgot-password', forgotPasswordLimiter);\napp.use('/auth/reset-password', resetPasswordLimiter);\napp.use('/auth/login', loginLimiter);\napp.use('/auth/signup', signupLimiter);\n\n//Routes\napp.use('/auth', authRouter);\napp.use('/courses', coursesRouter);\napp.use('/degree', degreeRouter);\napp.use('/exemption', exemptionRouter);\napp.use('/deficiency', deficiencyRouter);\napp.use('/timeline', timelineRouter);\napp.use('/coursepool', coursepoolRouter);\napp.use('/data', userDataRouter);\napp.use('/admin', Admin);\napp.use('/requisite', requisiteRouter);\napp.use('/feedback', feedbackRouter);\napp.use('/session', sessionRouter);\napp.use('/section', sectionsRoutes);\napp.use('/transcript', transcriptRouter);\n\n// MongoDB consolidated routes\napp.use('/v2', mongoRouter);\n\n/**\n * DB test route\n * TO BE REMOVED\n */\napp.get('/test-db', async (req, res) => {\n  try {\n    const pool = await Database.getConnection();\n    if (pool) {\n      const result = await pool.request().query('SELECT 1 AS number');\n      res.status(HTTP.OK).send({\n        message: 'Database connected successfully!',\n        result: result.recordset,\n      });\n    } else {\n      throw new Error('Connection error in test-db');\n    }\n  } catch (error) {\n    res\n      .status(HTTP.SERVER_ERR)\n      .send({ message: 'Database connection failed', error });\n  }\n});\n\n//Handle 404\napp.use(notFoundHandler);\n\n//Global Error Handler\napp.use(errorHandler);\n\n//Listen for requests\napp.listen(PORT, () => {\n  console.log(`Server listening on Port: ${PORT}`);\n});\n\n// This will make sure to capture unhandled async errors\nprocess.on('unhandledRejection', (reason: any) => {\n  Sentry.captureException(reason);\n  console.error('Unhandled Rejection:', reason);\n});\n"]}